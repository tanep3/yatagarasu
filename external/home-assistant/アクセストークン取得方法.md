`Authorization: Bearer <token>` で使う**Long-Lived Access Token**は、Home AssistantのAPIを外部プログラムから安全に叩くための「永続的な認証キー」です。  
これを作成するのは非常に簡単で、HAのUIから数クリックで完了します。以下に、現実的に落とし所をステップで共有します。

### Long-Lived Access Tokenの作成手順（公式・最新版）
1. **HAにログイン**  
   http://localhost:8123 または http://<HAのIP>:8123 にブラウザでアクセス  
   → 自分のユーザーでログイン（初回ウィザードで作ったアカウント）

2. **プロフィール画面へ**  
   - 左サイドバー下部のユーザーアイコン（自分の名前やアバター）をクリック  
   - 「Profile」または「プロフィール」を選択

3. **Long-Lived Access Tokensセクションを探す**  
   - ページ下の方に「Long-Lived Access Tokens」または「長期アクセストークン」という項目がある  
   - 「Create Token」または「トークンを作成」ボタンを押す

4. **トークン名を入力して作成**  
   - 名前を付ける（例: "tane-python-script" や "tapo-motion-trigger"）  
   - 作成ボタンを押すと、**一度だけトークン文字列**が表示される  
     （例: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiI... みたいな長い文字列）

5. **即時コピーして保存**  
   - 表示されたトークンをコピーして、**安全な場所に保存**（パスワードマネージャー、.envファイル、秘密管理ツール）  
   - **二度と再表示されない**ので、絶対に失くさないように  
   - 作成したら「OK」または閉じる

### 使い方の現実落とし所
- Python側で使う場合（requests例）:
  ```python
  headers = {
      "Authorization": "Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiI...YOUR_TOKEN_HERE",
      "Content-Type": "application/json"
  }
  ```
- 環境変数推奨（セキュリティ）:
  ```bash
  export HA_TOKEN="eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9..."
  ```
  Pythonで `os.getenv("HA_TOKEN")` で読み込み

### 注意点（実運用でよく起きるもの）
- **トークン失効**: ユーザーアカウントを削除したり、パスワード変更したりすると無効になる → 再作成
- **権限**: 作成したユーザーの権限がそのまま適用される（管理者ユーザー推奨）
- **HTTPS化**: 本番運用時はHAをHTTPSに（Let's Encryptアドオンなど）してwss://を使う
- **複数トークン**: スクリプトごとに別トークンを作って管理すると、後で無効化しやすい

この手順で進めれば、**Bearerトークンは5分以内で取得できます**。  
それでAPIテスト（例: GET /api/states）を自分のPythonから叩けるようになります。

